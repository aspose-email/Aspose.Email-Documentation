---
title: "Работа с вложениями и встроенными объектами"
url: /ru/python-net/working-with-attachments-and-embedded-objects/
weight: 50
type: docs
---


## **Управление вложениями электронных писем**
Вложение электронной почты - это файл, который отправляется вместе с сообщением электронной почты. Файл может быть отправлен как отдельное сообщение, так и как часть сообщения, к которому он прикреплен. Класс Attachment используется с классом MailMessage. Все сообщения содержат тело. В дополнение к телу вы можете отправить дополнительные файлы. Они отправляются как вложения и представлены как экземпляры класса Attachment. Вы можете отправить любое количество вложений, но размер вложения ограничен почтовым сервером. Gmail, например, не поддерживает файлы размером более 10 МБ.
{{% alert %}}
**Попробуйте!**

Добавьте или удалите вложения электронных писем онлайн с помощью бесплатного [**Aspose.Email Editor App**](https://products.aspose.app/email/ru/editor).
{{% /alert %}}
### **Добавление вложения**
Чтобы прикрепить вложение к электронному письму, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Создайте экземпляр класса Attachment.
1. Загрузите вложение в экземпляр Attachment.
1. Добавьте экземпляр Attachment в экземпляр класса MailMessage.

Следующий фрагмент кода показывает, как добавить вложение к электронному письму.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-AddEmailAttachments-AddEmailAttachments.py" >}}



Выше мы описали, как добавлять вложения к вашему сообщению электронной почты с помощью Aspose.Email. Далее показано, как удалить вложения и отобразить информацию о них на экране.
### **Удаление вложения**
Чтобы удалить вложение, выполните следующие шаги:

- Создайте экземпляр класса Attachment.
- Загрузите вложение в экземпляр класса Attachment.
- Добавьте вложение в экземпляр класса MailMessage.
- Удалите вложения из экземпляра класса Attachment с использованием экземпляра класса MailMessage.

Следующий фрагмент кода показывает, как удалить вложение.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RemovingAttachmentFromMailMessage-RemovingAttachmentFromMailMessage.py" >}}
### **Отображение имени файла вложения**
Чтобы отобразить имя файла вложения, выполните следующие шаги:

1. Переберите вложения в сообщении электронной почты и
   1. Сохраните каждое вложение.
   1. Отобразите имя каждого вложения на экране.

Следующий фрагмент кода показывает, как отобразить имя файла вложения на экране.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-DisplayAttachmentFileName-DisplayAttachmentFileName.py" >}}
### **Извлечение вложений из электронной почты**
Эта тема объясняет, как извлечь вложение из файла электронной почты. Вложение электронной почты - это файл, который отправляется вместе с сообщением электронной почты. Файл может быть отправлен как отдельное сообщение, так и как часть сообщения, к которому он прикреплен. Все сообщения электронной почты включают тело. В дополнение к телу вы можете отправить дополнительные файлы. Они отправляются как вложения и представлены как экземпляры класса Attachment. Класс Attachment используется с классом MailMessage для работы с вложениями. Чтобы извлечь вложения из сообщения электронной почты, выполните следующие шаги:

- Создайте экземпляр класса MailMessage.
- Загрузите файл электронной почты в экземпляр MailMessage.
- Создайте экземпляр класса Attachment и используйте его в цикле для извлечения всех вложений.
- Сохраните вложение и отобразите его на экране.
- Укажите адрес отправителя и получателя в экземпляре MailMessage.
- Теперь вы можете отправить электронное письмо с использованием класса SmtpClient.

Фрагменты кода извлекают вложения из электронной почты.

|**Извлеченные вложения в электронной почте**|
| :- |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_1.png)|
Следующий фрагмент кода показывает, как извлечь вложения электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.py" >}}
#### **Получение Content-Description из вложения**
API Aspose.Email предоставляет возможность читать заголовок Content-Description вложения. Следующий фрагмент кода показывает, как получить описание содержимого из вложения.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RetrievContentDescriptionFromAttachment-RetrievContentDescriptionFromAttachment.py" >}}
#### **Определение, является ли вложение встроенным сообщением**
{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-DetermineAttachmendEmbeddedMessage-DetermineAttachmendEmbeddedMessage.py" >}}
## **Работа с встроенными объектами**
Встроенный объект - это объект, созданный в одном приложении и заключенный в документ или файл, созданный другим приложением. Например, электронную таблицу Microsoft Excel можно встроить в отчет Microsoft Word, или видеофайл можно встроить в презентацию Microsoft PowerPoint. Когда файл встроен, а не вставлен или вставлен в другой документ, он сохраняет свой оригинальный формат. Встроенный документ можно открыть в оригинальном приложении и изменить.
### **Встраивание объектов в электронное письмо**
Удаление встроенных объектов из электронной почты

LinkedResourceCollection, доступный через свойство MailMessage.LinkedResources, предоставляет метод для полного удаления встроенных объектов, добавленных в сообщение электронной почты. Используйте перегруженную версию метода LinkedResourceCollection.RemoveAt, чтобы удалить все следы встроенного объекта из сообщения электронной почты.

Пример кода ниже показывает, как удалить встроенные объекты из сообщения электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RemoveLRTracesFromMessageBody-RemoveLRTracesFromMessageBody.py" >}}
### **Извлечение встроенных объектов**
Эта тема объясняет, как извлечь встроенные объекты из файла электронной почты. Встроенный объект - это объект, созданный в одном приложении и заключенный в документ или файл, созданный другим приложением. Например, электронную таблицу Microsoft Excel можно встроить в отчет Microsoft Word, или видеофайл можно встроить в презентацию Microsoft PowerPoint. Когда файл встроен, а не вставлен или вставлен в другой документ, он сохраняет свой оригинальный формат. Встроенный документ можно открыть в оригинальном приложении и изменить. Чтобы извлечь встроенный объект из сообщения электронной почты, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Загрузите файл электронной почты в экземпляр MailMessage.
1. Создайте цикл и создайте в нем экземпляр класса Attachment.
1. Сохраните вложение и отобразите его на экране.
1. Укажите адрес отправителя и получателя в экземпляре MailMessage.
1. Отправьте электронное письмо с использованием класса SmtpClient.

Фрагмент кода ниже извлекает встроенные объекты из электронной почты.

|**Извлеченные встроенные объекты в электронной почте**|
| :- |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_2.png)|
Следующий фрагмент кода показывает, как извлечь встроенные объекты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.py" >}}