---
title: "Работа с вложениями и встроенными объектами"
url: /ru/python-net/working-with-attachments-and-embedded-objects/
weight: 50
type: docs
---


## **Управление вложениями электронной почты**
Вложение электронной почты — это компьютерный файл, который отправляется вместе с сообщением электронной почты. Файл можно отправить как отдельное сообщение, так и как часть сообщения, к которому он прикреплен. Класс Attachment используется вместе с классом MailMessage. Все сообщения содержат текст. Помимо основного текста, возможно, вы захотите отправить дополнительные файлы. Они отправляются в виде вложений и представлены как экземпляры класса Attachment. Можно отправить любое количество вложений, но размер вложения ограничен почтовым сервером. Например, Gmail не поддерживает файлы размером более 10 МБ.
{{% alert %}}
**Попробуйте!**

Добавляйте или удаляйте вложения электронной почты онлайн бесплатно [**Приложение для редактирования электронной почты Aspose.Email**](https://products.aspose.app/email/ru/editor).
{{% /alert %}}
### **Добавление вложения**
Чтобы прикрепить вложение к электронному письму, выполните следующие действия:

1. Создайте экземпляр класса MailMessage.
1. Создайте экземпляр класса Attachment.
1. Загрузите вложение в экземпляр Attachment.
1. Добавьте экземпляр Attachment в экземпляр класса MailMessage.

В следующем фрагменте кода показано, как добавить вложение в электронное письмо.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-AddEmailAttachments-AddEmailAttachments.py" >}}



Выше мы описали, как добавлять вложения в сообщение электронной почты с помощью Aspose.Email. Ниже показано, как удалять вложения и отображать информацию о них на экране.
### **Удаление вложения**
Чтобы удалить вложение, выполните следующие действия:

- Создайте экземпляр класса Attachment.
- Загрузите вложение в экземпляре класса Attachment.
- Добавьте вложение к экземпляру класса MailMessage.
- Удалите вложения из экземпляра класса Attachment с помощью экземпляра класса MailMessage.

В следующем фрагменте кода показано, как удалить вложение.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RemovingAttachmentFromMailMessage-RemovingAttachmentFromMailMessage.py" >}}
### **Отображение имени вложенного файла**
Чтобы отобразить имя вложенного файла, выполните следующие действия:

1. Просмотрите вложения в сообщении электронной почты и
   1. Сохраните каждое вложение.
   1. Отобразите имя каждого вложения на экране.

В следующем фрагменте кода показано, как отобразить имя вложенного файла на экране.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-DisplayAttachmentFileName-DisplayAttachmentFileName.py" >}}
### **Извлечение вложений электронной почты**
В этом разделе описывается, как извлечь вложение из файла электронной почты. Вложение электронной почты — это компьютерный файл, который отправляется вместе с сообщением электронной почты. Файл можно отправить как отдельное сообщение, так и как часть сообщения, к которому он прикреплен. Все сообщения электронной почты содержат текст. Возможно, вы захотите отправить не только текст, но и дополнительные файлы. Они отправляются в виде вложений и представлены в виде экземпляров класса Attachment. Класс Attachment используется вместе с классом MailMessage для работы с вложениями. Чтобы извлечь вложения из сообщения электронной почты, выполните следующие действия:

- Создайте экземпляр класса MailMessage.
- Загрузите файл электронной почты в экземпляр MailMessage.
- Создайте экземпляр класса Attachment и используйте его в цикле для извлечения всех вложений.
- Сохраните вложение и отобразите его на экране.
- Укажите адрес отправителя и получателя в экземпляре MailMessage.
- Теперь вы можете отправлять электронную почту с помощью класса SmtpClient.

Фрагменты кода извлекают вложения из электронного письма.

|**Извлеченные вложения в электронном письме**|
|: - |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_1.png)|
В следующем фрагменте кода показано, как извлекать вложения электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.py" >}}
#### **Извлечение описания содержимого из вложения**
Aspose.Email API предоставляет возможность читать описание содержимого вложения из заголовка вложения. В следующем фрагменте кода показано, как получить описание содержимого из вложения.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RetrievContentDescriptionFromAttachment-RetrievContentDescriptionFromAttachment.py" >}}
#### **Определение того, является ли вложение встроенным сообщением**
{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-DetermineAttachmendEmbeddedMessage-DetermineAttachmendEmbeddedMessage.py" >}}
## **Работа со встроенными объектами**
Встроенный объект — это объект, созданный с помощью одного приложения и вложенный в документ или файл, созданный другим приложением. Например, электронную таблицу Microsoft Excel можно встроить в отчет Microsoft Word, а видеофайл — в презентацию Microsoft PowerPoint. Когда файл встраивается, а не вставляется или вставляется в другой документ, он сохраняет свой исходный формат. Встроенный документ можно открыть в исходном приложении и изменить.
### **Встраивание объектов в электронное письмо**
Удаление встроенных объектов из электронной почты

Коллекция LinkedResourceCollection, доступ к которой осуществляется через свойство MailMessage.LinkedResourceCollection, предоставляет метод полного удаления встроенных объектов, добавленных в сообщение электронной почты. Используйте перегруженную версию метода LinkedResourceCollection.removeAt для удаления всех следов встроенного объекта из сообщения электронной почты.

В приведенном ниже примере кода показано, как удалить встроенные объекты из сообщения электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-RemoveLRTracesFromMessageBody-RemoveLRTracesFromMessageBody.py" >}}
### **Извлечение встроенных объектов**
В этом разделе описывается, как извлечь встроенные объекты из файла электронной почты. Встроенный объект — это объект, созданный с помощью одного приложения и вложенный в документ или файл, созданный другим приложением. Например, электронную таблицу Microsoft Excel можно встроить в отчет Microsoft Word, а видеофайл — в презентацию Microsoft PowerPoint. Когда файл встраивается, а не вставляется или вставляется в другой документ, он сохраняет свой исходный формат. Встроенный документ можно открыть в исходном приложении и изменить. Чтобы извлечь встроенный объект из сообщения электронной почты, выполните следующие действия:

1. Создайте экземпляр класса MailMessage.
1. Загрузите файл электронной почты в экземпляр MailMessage.
1. Создайте цикл и создайте в нем экземпляр класса Attachment.
1. Сохраните вложение и отобразите его на экране.
1. Укажите адрес отправителя и получателя в экземпляре MailMessage.
1. Отправка электронной почты с помощью класса SmtpClient.

Приведенный ниже фрагмент кода извлекает встроенные объекты из электронного письма.

|**Извлеченные встроенные объекты в электронной почте**|
|: - |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_2.png)|
В следующем фрагменте кода показано, как извлекать встроенные объекты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.py" >}}
