---
title: "Создание и настройка содержимого электронных писем"
url: /ru/python-net/creating-and-setting-contents-of-emails/
weight: 10
type: docs
---


## **Создать новое сообщение электронной почты**
Класс MailMessage представляет собой сообщение электронной почты и позволяет разработчикам создавать новое сообщение электронной почты. Основные свойства электронной почты, такие как «От», «Кому», «Тема» и «Текст», можно легко прикрепить к вновь созданному почтовому сообщению. Точно так же мы можем сохранить почтовое сообщение в разных форматах, таких как EML, MSG и MHTML.

- Создайте экземпляр класса MailMessage.
- Задайте свойства почтового сообщения.
- Сохраните почтовое сообщение в разных форматах.

В следующем фрагменте кода показано, как создать новое электронное письмо с различными свойствами.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-CreateNewMailMesssage-CreateNewMailMesssage.py" >}}
## **Указание нескольких получателей**
MailMessage представляет собой сообщение электронной почты. Экземпляры класса MailMessage используются для создания сообщений электронной почты, которые передаются на SMTP-сервер с помощью класса SmtpClient. В этом разделе показано, как указать несколько адресов электронной почты. Адреса электронной почты можно указать с помощью класса MailMessage. В классе MailMessage используются следующие адреса электронной почты:

- **To** - Адреса получателей можно указать в поле «Кому». Получатели в поле «Кому» являются основной аудиторией сообщений. Адресов получателей может быть несколько
- **Cc** - CC расшифровывается как «точная копия» или «любезная копия» и позволяет добавлять получателей электронной почты, которым необходимо ознакомиться с письмом, но от которых не требуется никаких действий по нему. Например, руководители или члены вашей команды, которым необходимо быть в курсе разговоров. С помощью Aspose.Email в коде можно указать адреса CC. Таким образом, автоматические электронные письма или все электронные письма на определенный адрес могут быть скопированы соответствующему персоналу.
- **Bcc** - Bcc, «слепая копия», позволяет отправлять получателю электронное письмо, скрытое от других получателей. Если в информации по электронной почте, которую видят основные получатели, буква «CC» отображается, то в ней нет. Оно предназначено для скрытых уведомлений. 

Чтобы указать несколько адресов электронной почты в сообщении электронной почты, выполните следующие действия:

1. Создайте экземпляр класса MailMessage.
1. Укажите адрес From и несколько адресов To, Cc и Bcc, используя экземпляр MailMessage.
1. Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

В приведенном ниже примере кода показано, как можно указать несколько адресов To, CC и BCC.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-SpecifyRecipientAddresses-SpecifyRecipientAddresses.py" >}}
## **Изменение адресов электронной почты на понятное имя**
В приведенных ниже примерах программирования показано, как изменить адреса электронной почты на удобные имена в сообщении электронной почты. Дружественное имя — это имя, более удобное для пользователя, чем адрес электронной почты. Например, Джон Смит вместо js346@domain.com. При отправке электронного письма мы можем связать понятное имя с адресом электронной почты в конструкторе класса MailMessage.

Чтобы изменить адреса электронной почты на удобные имена в сообщении электронной почты, выполните следующие действия:

- Создайте экземпляр класса MailMessage и укажите адреса электронной почты в поле **To** and **From** поля вместе с понятными именами.
- Укажите адреса электронной почты Cc и Bcc, а также удобные имена, вызвав конструктор класса MailMessage в экземпляре MailMessage.
- Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

В следующем фрагменте кода показано, как отображать имена для адресов электронной почты.

{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ChangeEmailAddress-ChangeEmailAddress.py" >}}
## **Установить тело письма**
Класс MailMessage представляет собой сообщение электронной почты. Экземпляры класса MailMessage используются для создания сообщений электронной почты, которые передаются на SMTP-сервер для доставки с использованием класса SmtpClient. Текст письма можно указать с помощью класса MailMessage. Электронное письмо может состоять из нескольких текстов. В классе MailMessage существует два типа сообщений электронной почты:

- Тело HTML
- Тело текста

Помимо HTMLBody и TextBody, Aspose.Email имеет еще два свойства, доступных только для чтения, связанных с телом письма:

- isBodyText: сообщает пользователю, является ли текст текстом.
- isBodyHTML: сообщает пользователю, является ли тело HTML или обычным текстом.

В этой статье показано, как определить простой текст или основной текст HTML, задать альтернативный текст и закодировать тело письма.
### **Настройка тела HTML**
HTMLBody используется для указания HTML-содержимого тела сообщения. HTMLBody должен быть заключен между <html> </html> теги. В следующем фрагменте кода показано, как настроить тело HTML.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-SetHTMLBody-SetHTMLBody.py" >}}
### **Настройка альтернативного текста**
Используйте класс AlternateView для указания копий сообщения электронной почты в другом формате. Например, если вы отправляете сообщение в формате HTML, вы также можете предоставить текстовую версию на случай, если некоторые из получателей используют программы чтения электронной почты, которые не могут отображать содержимое HTML. Этот класс имеет два свойства, LinkedResources и baseURI, которые используются для разрешения URL-адресов в содержимом письма.

- LinkedResources — это набор объектов LinkedResources. При рендеринге URL-адреса в содержимом письма сначала сопоставляются с URL-адресами в ссылке на содержимое каждого объекта LinkedResources в коллекции LinkedResources и затем удаляются.
- BaseURI используется программой чтения почты для разрешения относительных URL-адресов в тексте, а также для разрешения относительных URL-адресов ссылок на содержимое в коллекции LinkedResources.

В следующем фрагменте кода показано, как задать альтернативный текст.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-AlternateText-AlternateText.py" >}}
## **Функции почтовых сообщений**
The [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) класс представляет собой содержимое сообщения электронной почты. Экземпляры [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) класс используется для создания сообщения электронной почты, которое передается на SMTP-сервер для доставки с использованием [SmtpClient](https://apireference.aspose.com/email/net/aspose.email.clients.smtp/smtpclient) класс. В этой статье показано, как использовать [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) служебные функции класса для управления следующими функциями электронной почты:

- **Дата и время** - Через [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) свойство class Date, которое мы получаем или устанавливаем дату и время электронного письма.
- **Приоритет сообщений** - [MailPriority](https://apireference.aspose.com/email/net/aspose.email/mailpriority) класс определяет уровни приоритета для отправки сообщения электронной почты. Он может быть низким, нормальным или высоким. Приоритет влияет на скорость передачи и доставку.
- **Чувствительность сообщений** - [MailSensitivity](https://apireference.aspose.com/email/net/aspose.email/mailsensitivity) класс определяет пять уровней чувствительности.
- **Уведомление о доста** - Уведомления о доставке сообщают отправителям, что отправленное ими электронное письмо было доставлено в почтовый ящик получателя.

По умолчанию дата — это фактическая дата отправки сообщения, а время — время отправки, отображаемое в Microsoft Outlook. Однако реальное время доставки электронной почты добавляется самим SMTP-сервером в заголовке письма. Например, ниже приведен обычный заголовок письма, где «Дата» задает поле «Дата».



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-DateAndTime-DateAndTime.py" >}}



Приведенный ниже фрагмент кода иллюстрирует, как можно использовать каждую из описанных выше функций.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-MailMessageFeatures-MailMessageFeatures.py" >}}
## **Запрос квитанции о прочтении**
В приведенных ниже примерах программирования показано, как можно запросить квитанцию о прочтении. [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) class [DeliveryNotificationOptions](https://apireference.aspose.com/email/net/aspose.email/deliverynotificationoptions) Свойство Enumeration описывает параметры уведомления о доставке электронного письма. Чтобы запросить квитанцию о прочтении после отправки электронного письма, выполните следующие действия:

1. Создайте экземпляр [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) class.
1. Укажите отправителя, получателя и текст HTML для письма в поле [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) instance.
1. Укажите [DeliveryNotificationOptions](https://apireference.aspose.com/email/net/aspose.email/deliverynotificationoptions) в другом [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) instances.
1. Создайте экземпляр [SmtpClient](https://apireference.aspose.com/email/net/aspose.email.clients.smtp/smtpclient) класс и отправьте электронное письмо с помощью метода Send.

Запросы на получение квитанции о прочтении могут быть выполнены не всегда по следующим причинам:

- Почтовый клиент может не реализовать эту функциональность.
- У конечного пользователя эта функция может быть отключена.
- Конечный пользователь может отказаться от отправки.

В следующем фрагменте кода показано, как запросить квитанцию о прочтении.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-RequestReadReceipt-RequestReadReceipt.py" >}}
## **Настройка заголовков электронной почты**
Заголовки электронных писем представляют собой стандарт Интернета, а RFC определяет поля заголовков, которые включаются в сообщения электронной почты Интернета. Заголовок электронного письма можно указать с помощью класса MailMessage. Общие типы заголовков определены в классе HeaderType. Это запечатанный класс, работающий как обычное перечисление.

Обычно заголовок электронного письма содержит следующие поля:

- Кому: адреса получателей можно указать в поле **To** поле. **To** получатели поля — основная аудитория сообщения. Адресов получателей может быть несколько.
- От: в этом поле указан адрес электронной почты отправителя сообщения.
- Cc: позволяет пользователям отправлять сообщения в виде «точной копии» или «любезной копии». То есть получатель не должен отвечать или действовать. Как правило, руководящий персонал уведомляется с помощью CC.
- Bcc: расшифровывается как Blind Carbon Copy и означает практику отправки сообщения нескольким получателям таким образом, чтобы полученное сообщение не содержало полного списка получателей. Оно предназначено для скрытого уведомления.
- ReplyTo: это поле заголовка предназначено для указания того, куда отправитель хочет отправить ответы.
- Тема: Заголовок, заголовок, тема. Часто используется в качестве индикатора темы для сообщений, отвечающих на другие сообщения или комментирующих их.
- Дата: в этом заголовке указаны дата (и время). Обычно это дата составления и отправки сообщения.
- XMailer: информация о клиентском программном обеспечении автора. Пример: программа X-Mailer: Aspose.Email. XMailer используется почтовыми клиентами. Разные почтовые клиенты будут иметь разные значения XMailer. Значение XMailer в MS Outlook — Microsoft Office Outlook, сборка 11.0.5510. Получатель электронной почты или программа для чтения электронной почты игнорируют его.

Обычно заголовок электронного письма выглядит следующим образом:

``` cs

 Reply-To: reply@reply.com

From: sender@sender.com

To: guangzhou@guangzhoo.com

Subject: test mail

Date: 6 Mar 2006 8:2:2 +0800

X-Mailer: Aspose.Email

```

Чтобы настроить заголовок электронного письма, выполните следующие действия:

- Создайте экземпляр [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) class.
- Укажите «Кому», «Откуда», «CC», «Bcc», «Ответить», «Тему», «Дату» и «XMailer», используя экземпляр [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
- Создайте экземпляр [MimeHeader](https://apireference.aspose.com/email/net/aspose.email.mime/mimeheader) класс и укажите секретный заголовок.
- Добавьте секретный заголовок в [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) instance.

В следующем фрагменте кода показано, как настроить заголовки электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-SetEmailHeaders-SetEmailHeaders.py" >}}



Приведенный выше фрагмент кода создает заголовок электронного письма в следующем формате. Это можно увидеть, открыв полученный файл «MsgHeaders.msg» в Microsoft Outlook и затем просмотрев «Свойства».

``` cs

 Reply-To: reply@reply.com

From: sender@sender.com

To: receiver1@receiver.com

CC: receiver2@receiver.com

BCC: receiver3@receiver.com

Subject: test mail

Date: 6 Mar 2006 8:2:2 +0800

X-Mailer: Aspose.Email

secret-header: mystery

```
### **Вставить заголовок в определенном месте**
The [Add](https://apireference.aspose.com/email/net/aspose.email.mime.headercollection/add/methods/1) метод [HeadersCollection](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection) класс вставляет заголовок в конец коллекции. Однако иногда может возникнуть необходимость вставить заголовок в определенном месте. В таком случае [Add](https://apireference.aspose.com/email/net/aspose.email.mime.headercollection/add/methods/1) метод не поможет. Для этого используйте [Insert](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection/methods/insert) метод [HeadersCollection](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection). Если коллекция содержит заголовки с одинаковыми именами, этот заголовок будет вставлен перед другими заголовками с таким же именем. В следующем фрагменте кода показано, как вставить заголовок в определенное место.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-InsertHeaderAtSpecificLocation-InsertHeaderAtSpecificLocation.py" >}}
### **Добавление настраиваемых заголовков в электронное письмо**
В приведенных ниже примерах программирования показано, как указать пользовательский заголовок в сообщении электронной почты. Заголовок электронного письма можно указать с помощью [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) класс. Чтобы указать пользовательский заголовок в сообщении электронной почты, выполните следующие действия:

1. Создайте экземпляр [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) class.
1. Укажите значения «кому», «от» и «тема», используя экземпляр MailMessage.
1. Добавьте секретный заголовок в [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) instance.
1. Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

В следующем фрагменте кода показано, как добавлять собственные заголовки в электронное письмо.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-SpecifyCustomHeader-SpecifyCustomHeader.py" >}}
