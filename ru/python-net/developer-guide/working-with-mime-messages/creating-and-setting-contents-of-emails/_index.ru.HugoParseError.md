---
title: Создание и настройка содержимого электронных писем
type: docs
weight: 10
url: /python-net/creating-and-setting-contents-of-emails/
---


## **Создание нового электронного сообщения**
Класс MailMessage представляет электронное сообщение и позволяет разработчикам создавать новые электронные сообщения. Основные свойства электронной почты, такие как От, Кому, Тема и тело, могут быть легко прикреплены к вновь созданному электронному сообщению. Аналогичным образом мы можем сохранить электронное сообщение в различных форматах, таких как EML, MSG и MHTML.

- Создайте экземпляр класса MailMessage.
- Установите свойства электронного сообщения.
- Сохраните электронное сообщение в различных форматах.

Следующий кодовый фрагмент показывает, как создать новое электронное сообщение с различными свойствами.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-CreateNewMailMesssage-CreateNewMailMesssage.py" >}}
## **Указание нескольких получателей**
MailMessage представляет собой электронное сообщение. Экземпляры класса MailMessage используются для создания электронных сообщений, которые передаются на SMTP-сервер с использованием класса SmtpClient. В этом разделе показано, как указать более одного адреса электронной почты. Адреса электронной почты могут быть указаны с помощью класса MailMessage. Адреса электронной почты, используемые в классе MailMessage:

- **Кому** - Адреса получателей могут быть указаны в поле 'Кому'. Получатели в поле 'Кому' составляют основную аудиторию сообщения. Может быть более одного адреса получателя
- **Копия** - CC означает "углеродная копия" или "копия для вежливости" и позволяет вам добавить адресатов электронной почты, которые должны видеть электронное письмо, но от которых не ожидается непосредственной реакции. Например, менеджеры или члены вашей команды, которые должны быть в курсе разговора. С помощью Aspose.Email адреса CC могут быть указаны в вашем коде. Таким образом, автоматические электронные письма или все электронные письма на определенный адрес могут быть скопированы соответствующему персоналу.
- **Скрытая копия** - Bcc, скрытая углеродная копия, позволяет отправить электронное письмо получателю, скрытому от других получателей. В то время как CC отображается в информации о электронном письме, которую видят основные получатели, Bcc - нет. Оно предназначено для скрытого уведомления.

Чтобы указать несколько адресов электронной почты в электронном сообщении, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Укажите адреса От и несколько адресов Кому, Копия и Скрытая копия с помощью экземпляра MailMessage.
1. Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

Пример кода ниже показывает, как можно указать несколько адресов Кому, Копия и Скрытая копия.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-SpecifyRecipientAddresses-SpecifyRecipientAddresses.py" >}}
## **Изменение адресов электронной почты на дружеские имена**
Ниже приведены примеры программ, которые демонстрируют, как изменить адреса электронной почты на дружеские имена в электронном сообщении. Дружеское имя - это имя, которое более удобно для восприятия, чем адрес электронной почты, например, Джон Смит вместо js346@domain.com. При отправке электронного письма мы можем ассоциировать дружеское имя с адресом электронной почты в конструкторе класса MailMessage.

Чтобы изменить адреса электронной почты на дружеские имена в электронном сообщении, выполните следующие шаги:

- Создайте экземпляр класса MailMessage и укажите адреса электронной почты в полях **Кому** и **От** вместе с дружескими именами.
- Укажите адреса электронной почты Копия и Скрытая копия вместе с дружескими именами, вызвав конструктор класса MailMessage в экземпляре MailMessage.
- Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

Следующий кодовый фрагмент показывает, как отобразить имена для адресов электронной почты.

{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-ChangeEmailAddress-ChangeEmailAddress.py" >}}
## **Установка тела письма**
Класс MailMessage представляет собой электронное сообщение. Экземпляры класса MailMessage используются для создания электронных сообщений, которые передаются на SMTP-сервер для доставки с использованием класса SmtpClient. Тело письма можно указать с помощью класса MailMessage. У электронной почты может быть несколько тел. В классе MailMessage есть два типа тел писем:

- HTML тело
- Текстовое тело

В дополнение к HtmlBody и TextBody, Aspose.Email имеет еще два свойства только для чтения, связанные с телом письма:

- IsBodyText: сообщает пользователю, является ли тело текстом.
- IsBodyHtml: сообщает пользователю, является ли тело HTML или обычным текстом.

В этой статье показано, как определить текст тела как обычный текст или HTML, установить альтернативный текст и закодировать тело электронного письма.
### **Установка HTML тела**
HtmlBody используется для указания HTML-содержимого тела сообщения. HtmlBody должен быть заключен между тегами <html> </html>. Следующий кодовый фрагмент показывает, как установить HTML тело.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-SetHTMLBody-SetHTMLBody.py" >}}
### **Установка альтернативного текста**
Используйте класс AlternateView для указания копий электронного сообщения в другом формате. Например, если вы отправляете сообщение в HTML, вы также можете предоставить версию в обычном тексте на случай, если некоторые из получателей используют почтовые клиенты, которые не могут отображать HTML-контент. Этот класс имеет два свойства, LinkedResources и BaseUri, которые используются для разрешения URL в содержимом электронной почты.

- LinkedResources представляет собой коллекцию объектов LinkedResources. При рендеринге URL в содержимом электронной почты сначала сопоставляются с URL в Content Link каждого объекта LinkedResources в коллекции LinkedResources и разрешаются.
- BaseUri используется почтовым клиентом для разрешения относительных URL в теле, а также для разрешения относительных URL контента в коллекции LinkedResources.

Следующий кодовый фрагмент показывает, как установить альтернативный текст.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithMimeMessages-AlternateText-AlternateText.py" >}}
## **Функции MailMessage**
Класс [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) представляет содержимое электронного сообщения. Экземпляры класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) используются для создания электронного сообщения, которое передается на SMTP-сервер для доставки с использованием класса [SmtpClient](https://apireference.aspose.com/email/net/aspose.email.clients.smtp/smtpclient). В этой статье показано, как использовать утилиты класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) для управления следующими функциями электронной почты:

- **Дата и время** - Через свойство [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) Date мы получаем или устанавливаем дату и время электронной почты.
- **Приоритет сообщения** - Класс [MailPriority](https://apireference.aspose.com/email/net/aspose.email/mailpriority) определяет уровни приоритета для отправки электронного сообщения. Он может быть низким, нормальным или высоким. Приоритет влияет на скорость передачи и доставку.
- **Чувствительность сообщения** - Класс [MailSensitivity](https://apireference.aspose.com/email/net/aspose.email/mailsensitivity) определяет пять уровней чувствительности.
- **Уведомление о доставке** - Уведомления о доставке информируют отправителей о том, что электронное письмо было доставлено в почтовый ящик получателя.

По умолчанию дата является фактической датой, когда сообщение было отправлено, а время - временем, когда оно было отправлено, как отображается в Microsoft Outlook. Однако реальное время доставки электронной почты добавляется самим SMTP-сервером в заголовок письма. Например, ниже приведен обычный заголовок письма, где поле Date задает значение даты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-DateAndTime-DateAndTime.py" >}}



Ниже представлен кодовый фрагмент, который иллюстрирует, как можно использовать каждую из обсуждаемых выше функций.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-MailMessageFeatures-MailMessageFeatures.py" >}}
## **Запрос подтверждения чтения**
Примеры программ ниже показывают, как можно запросить подтверждение чтения. Свойство перечисления [DeliveryNotificationOptions](https://apireference.aspose.com/email/net/aspose.email/deliverynotificationoptions) класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage) описывает варианты уведомления о доставке для электронного письма. Чтобы запросить подтверждение чтения после отправки электронного письма, выполните следующие шаги:

1. Создайте экземпляр класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
1. Укажите отправителя, получателя и HTML-содержимое для электронного письма в экземпляре [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
1. Укажите [DeliveryNotificationOptions](https://apireference.aspose.com/email/net/aspose.email/deliverynotificationoptions) в других экземплярах [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
1. Создайте экземпляр класса [SmtpClient](https://apireference.aspose.com/email/net/aspose.email.clients.smtp/smtpclient) и отправьте электронное письмо с помощью метода Send.

Запросы на подтверждение чтения могут не всегда выполняться, так как:

- Почтовый клиент может не реализовать такую функциональность.
- Конечный пользователь может отключить эту функциональность.
- Конечный пользователь может выбрать не отправлять подтверждение.

Следующий кодовый фрагмент показывает, как запросить подтверждение чтения.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-RequestReadReceipt-RequestReadReceipt.py" >}}
## **Установка заголовков электронной почты**
Заголовки электронной почты представляют собой интернет-стандарт, а RFC определяет поля заголовков, которые включены в интернет-электронные сообщения. Заголовок электронной почты может быть указан с помощью класса MailMessage. Обычные типы заголовков определены в классе HeaderType. Это запечатанный класс, работающий как обычная перечисление.

Как правило, заголовок электронной почты содержит следующие поля:

- Кому: адреса получателей могут быть указаны в поле **Кому**. Получатели в поле **Кому** составляют основную аудиторию сообщения. Может быть более одного адреса получателя.
- От: это поле представляет адрес электронной почты отправителя сообщения.
- Копия: позволяет пользователям отправлять сообщение как "углеродную копию" или "копию для вежливости". То есть, от получателя не ожидается ответа или действий. Обычно с помощью CC уведомляют руководящий персонал.
- Скрытая копия: это означает "Скрытая углеродная копия", относится к практике отправки сообщения нескольким получателям таким образом, что то, что они получают, не содержит полного списка получателей. Это предназначено для скрытого уведомления.
- ОтветитьНа: это поле заголовка предназначено для указания, куда отправитель хочет, чтобы приходили ответы.
- Тема: название, заголовок, тема. Часто используется как индикатор темы для сообщений, отвечающих или комментирующих на другие сообщения.
- Дата: этот заголовок указывает дату (и время). Обычно это дата, в которой сообщение было составлено и отправлено.
- XMailer: информация о программном обеспечении клиента отправителя. Пример: X-Mailer: Aspose.Email. XMailer используется почтовыми клиентами. У разных почтовых клиентов будут разные значения XMailer. Значение XMailer для MS Outlook - Microsoft Office Outlook, Build 11.0.5510. Оно игнорируется получателем или почтовым клиентом.

Как правило, заголовок электронной почты выглядит следующим образом:

``` cs

 Reply-To: reply@reply.com

From: sender@sender.com

To: guangzhou@guangzhoo.com

Subject: тестовое письмо

Date: 6 Мар 2006 8:2:2 +0800

X-Mailer: Aspose.Email

```

Чтобы настроить заголовок электронной почты, выполните следующие шаги:

- Создайте экземпляр класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
- Укажите Кому, От, Копия, Скрытая копия, ОтветитьНа, Тема, Дата и XMailer, используя экземпляр класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
- Создайте экземпляр класса [MimeHeader](https://apireference.aspose.com/email/net/aspose.email.mime/mimeheader) и укажите секретный заголовок.
- Добавьте секретный заголовок к экземпляру [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).

Следующий кодовый фрагмент показывает, как установить заголовки электронной почты.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-SetEmailHeaders-SetEmailHeaders.py" >}}



Этот кодовый фрагмент создает заголовок электронной почты в следующем формате. Это можно увидеть, открыв результирующий файл "MsgHeaders.msg" в Microsoft Outlook и затем просмотрев свойства.

``` cs

 Reply-To: reply@reply.com

From: sender@sender.com

To: receiver1@receiver.com

CC: receiver2@receiver.com

BCC: receiver3@receiver.com

Subject: тестовое письмо

Date: 6 Мар 2006 8:2:2 +0800

X-Mailer: Aspose.Email

secret-header: mystery

```
### **Вставка заголовка в определенное место**
Метод [Add](https://apireference.aspose.com/email/net/aspose.email.mime.headercollection/add/methods/1) класса [HeadersCollection](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection) вставляет заголовок в конец коллекции. Однако иногда может быть необходимо вставить заголовок в конкретное место. В таком случае метод [Add](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection/add/methods/1) не подойдет. Для этого используйте метод [Insert](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection/methods/insert) класса [HeadersCollection](https://apireference.aspose.com/email/net/aspose.email.mime/headercollection). Если коллекция содержит заголовки с одинаковым именем, этот заголовок будет вставлен перед другими заголовками с тем же именем. Следующий кодовый фрагмент показывает, как вставить заголовок в определенное место.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-InsertHeaderAtSpecificLocation-InsertHeaderAtSpecificLocation.py" >}}
### **Добавление пользовательских заголовков в электронное письмо**
Ниже приведены примеры программ, которые демонстрируют, как указать пользовательский заголовок в электронном сообщении. Заголовок электронной почты может быть указан с помощью класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage). Чтобы указать пользовательский заголовок в электронном сообщении, выполните следующие шаги:

1. Создайте экземпляр класса [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
1. Укажите значения для поля Кому, От и Тема, используя экземпляр MailMessage.
1. Добавьте секретный заголовок в экземпляр [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage).
1. Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

Следующий кодовый фрагмент показывает, как добавить пользовательские заголовки в электронное письмо.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-SpecifyCustomHeader-SpecifyCustomHeader.py" >}}