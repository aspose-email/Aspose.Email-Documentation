---
title: "Создание и сохранение файлов MSG"
url: /ru/python-net/creating-and-saving-msg-files/
weight: 10
type: docs
---


Aspose.Email поддерживает создание файлов сообщений Outlook (MSG). В этой статье объясняется, как:

- Создавайте сообщения MSG.
- Создавайте сообщения MSG с вложениями.
- Создайте сообщение MSG с телом RTF.
- Сохраните сообщение как черновик.
- Работа со сжатием тела.
## **Создание и сохранение сообщений Outlook**
В классе MailMessage есть метод Save (), который позволяет сохранять файлы Outlook MSG на диск или в потоковом режиме. Приведенные ниже фрагменты кода создают экземпляр класса MailMessage, задают такие свойства, как from, to, subject и body. Метод Save () принимает имя файла в качестве аргумента. Кроме того, сообщения Outlook можно создавать из сжатого тела RTF с помощью опции MapiConversionOptions. Для настройки создайте новое приложение Windows и добавьте ссылку на dll Aspose.Email в проект.

1. Создайте новый экземпляр класса MailMessage и задайте свойства From, To, Subject и Body.
1. Вызовите метод класса MailMessage FromMailMessage, который принимает объект типа MailMessage. Метод fromMailMessage () преобразует почтовое сообщение в почтовое сообщение (MSG).
1. Вызовите метод MapiMessage.save () для сохранения файла MSG.

Напишите следующий код в событии нажатия кнопки управления приложением Windows.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-CreatingAndSavingOutlookMSG-CreatingAndSavingOutlookMSG.py" >}}
## **Создание файлов MSG с вложениями**
В приведенном выше примере мы создали простой файл MSG. Aspose.Email также поддерживает сохранение файлов сообщений с вложениями. Все, что вам нужно сделать, это добавить вложения в экземпляр MailMessage. Добавьте вложения, вызвав метод Add () в коллекции MailMessage.attachments. Добавьте список в созданную выше форму и добавьте две кнопки, по одной для добавления и удаления вложений. Приложение, добавляющее приложения, работает следующим образом:

1. Когда **Добавить вложение** кнопка нажата, **Диалог «Открыть файл»** отображается, чтобы помочь пользователям найти и выбрать вложение.
1. После выбора файла полный путь добавляется в список.
1. При создании файла MSG пути к вложениям извлекаются из списка и добавляются в коллекцию MailMessage.Attachments.

Напишите следующий код в поле **Добавить вложение** событие нажатия кнопки.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-AddingMSGAttachments-AddingMSGAttachments.py" >}}

Добавьте код для добавления вложений в экземпляр MailMessage. Окончательный код функции Write Msg написан следующим образом.

{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-AddingMSGAttachments-AddingMSGAttachments.py" >}}


## **Создание файлов MSG с помощью тела RTF**
С помощью Aspose.Email можно также создавать файлы сообщений Outlook (MSG) с телами RTF. Тело RTF поддерживает форматирование текста. Создайте его, установив свойство MailMessage.htmlBody. При преобразовании экземпляра MailMessage в экземпляр MailMessage тело HTML преобразуется в формат RTF. Таким образом, форматирование тела письма сохраняется.

В следующем примере создается файл MSG с телом RTF. В тексте HTML используется один заголовок, полужирный шрифт и подчеркивание. Это форматирование сохраняется при преобразовании HTML в RTF.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-CreatingMSGFilesWithRtfBody-CreatingMSGFilesWithRtfBody.py" >}}
## **Сохранение сообщения в статусе черновика**
Письма сохраняются как черновики, когда кто-то начал их редактировать, но хочет вернуться к ним, чтобы завершить их позже. Aspose.Email поддерживает сохранение сообщения электронной почты в черновике, установив флаг сообщения. Ниже приведен пример кода для сохранения сообщения электронной почты Outlook (MSG) в виде черновика.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-SavingMessageInDraftStatus-SavingMessageInDraftStatus.py" >}}
## **Последствия компрессии тела**
Метод сжатия тела RTF можно использовать для получения глутамата натрия меньшего размера. Однако это приводит к снижению скорости. Чтобы создавать сообщения с повышенной скоростью, установите флаг в значение false. Этот флаг, в свою очередь, влияет на созданные файлы PST: файлы MSG меньшего размера приводят к уменьшению размера PST, а большие файлы MSG возвращаются к более медленному созданию PST.



{{< gist "aspose-email" "356f0e128b9d45a7ee779fc813eb87e5" "Examples-WorkingWithOutlookMSGs-SetBodyCompression-SetBodyCompression.py" >}}



