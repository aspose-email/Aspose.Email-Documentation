---
title: Создание и сохранение файлов MSG Outlook с использованием C++ Email API
linktitle: Создание и сохранение файлов MSG
type: docs
weight: 10
url: /cpp/creating-and-saving-msg-files/
description: API парсера электронной почты C++ поддерживает создание файлов MSG сообщений Outlook с вложениями, телом в формате RTF и сохранение сообщения в статусе черновика.
---

## **Создание и сохранение файлов MSG**
Aspose.Email поддерживает создание файлов сообщений Outlook (MSG). В этой статье объясняется, как:

- Создать сообщения MSG.
- Создать сообщения MSG с вложениями.
- Создать сообщение MSG с телом в формате RTF.
- Сохранить сообщение как черновик.
- Работать со сжатием тела.

### **Создание и сохранение сообщений Outlook**
Класс MailMessage имеет метод Save(), который может сохранять файлы MSG Outlook на диск или в поток. Приведенные ниже фрагменты кода создают экземпляр класса MailMessage, устанавливают свойства, такие как from, to, subject и body. Метод Save() принимает имя файла в качестве аргумента. Кроме того, сообщения Outlook могут быть созданы с сжатым телом RTF с использованием MapiConversionOptions. Для настройки создайте новое приложение Windows и добавьте ссылку на библиотеку Aspose.Email в проект.

1. Создайте новый экземпляр класса MailMessage и установите свойства From, To, Subject и Body.
1. Вызовите метод FromMailMessage класса MailMessage, который принимает объект типа MailMessage. Метод FromMailMessage() конвертирует MailMessage в MailMessage (MSG).
1. Вызовите метод MapiMessage.Save(), чтобы сохранить файл MSG.

Напишите следующий код в событии click элемента управления кнопкой приложения Windows.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-CreatingAndSavingOutlookMessages-CreatingAndSavingOutlookMessages.cpp" >}}

### **Создание файлов MSG с телом RTF**
Вы также можете создавать файлы сообщений Outlook (MSG) с текстом в формате rich text (RTF) с помощью Aspose.Email. Тело RTF поддерживает форматирование текста. Создайте его, установив свойство MailMessage.HtmlBody. При преобразовании экземпляра MailMessage в экземпляр MailMessage тело HTML преобразуется в RTF. Таким образом, форматирование тела электронной почты сохраняется.

Следующий пример создает файл MSG с телом RTF. В теле HTML есть один заголовок, а также применены жирное начертание и подчеркивание. Это форматирование сохраняется при преобразовании HTML в RTF.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-CreatingMSGFilesWithRTFBody-CreatingMSGFilesWithRTFBody.cpp" >}}

### **Сохранение сообщения в статусе черновика**
Электронные письма сохраняются как черновики, когда кто-то начал их редактировать, но хочет вернуться к ним для завершения позже. Aspose.Email поддерживает сохранение сообщения электронной почты в статусе черновика, устанавливая флаг сообщения. Ниже приведен пример кода для сохранения сообщения электронной почты Outlook (MSG) как черновика.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SavingMessageInDraftStatus-SavingMessageInDraftStatus.cpp" >}}

### **Последствия сжатия тела**
Метод сжатия тела RTF может использоваться для генерации файлов MSG меньшего размера. Однако это приводит к более медленной работе. Чтобы создавать сообщения с улучшенной скоростью, установите флаг в false. Этот флаг, в свою очередь, влияет на созданные PST: меньшие файлы MSG приводят к меньшему PST, а большие файлы MSG возвращают более медленное создание PST.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SetBodyCompression-SetBodyCompression.cpp" >}}