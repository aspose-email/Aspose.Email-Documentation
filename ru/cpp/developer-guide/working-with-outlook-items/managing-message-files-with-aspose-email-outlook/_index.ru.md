---
title: "Управление файлами сообщений Outlook с помощью C++ Email Parser API"
description: "C++ Email Parser Library API полезна для чтения, записи шаблона файла OFT Outlook, управления цифровыми подписями сообщений, установки цветовой категории и доступа к информации о подтверждении доставки."
url: /ru/cpp/managing-message-files-with-aspose-email-outlook/
weight: 30
type: docs
linktitle: "Управление файлами сообщений с Aspose.Email.Outlook"
---

## **Чтение и запись файла шаблона Outlook (.OFT)**
Шаблоны Outlook очень полезны, когда вы хотите отправить похожее электронное сообщение снова и снова. Вместо того чтобы каждый раз готовить сообщение с нуля, сначала подготовьте его в Outlook и сохраните как шаблон Outlook (OFT). После этого, когда вам нужно отправить сообщение, вы можете создать его из шаблона, что сэкономит время на написание одного и того же текста в теле или строке темы, настройку форматирования и так далее. Класс MailMessage из Aspose.Email может быть использован для загрузки и чтения файла шаблона Outlook (OFT). После загрузки шаблона Outlook в экземпляр класса MailMessage, вы можете обновить отправителя, получателя, тело, тему и другие свойства. После обновления свойств:

- Отправьте электронное письмо с помощью класса SmtpClient или
- Сохраните сообщение в формате MSG и выполните дальнейшие обновления/валидацию с помощью Microsoft Outlook.

В приведенных ниже примерах кода мы:

1. Загружаем шаблон с помощью класса MailMessage.
1. Обновляем некоторые свойства.
1. Сохраняем сообщение в формате MSG.

Следующий фрагмент кода показывает, как загрузить файл OFT с помощью API C++ Email Parser Library, обновить сообщение и сохранить его в формате MSG.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ReadAndWritingOutlookTemplateFile-ReadAndWritingOutlookTemplateFile.cpp" >}}

## **Управление цифровыми подписями сообщений**
Aspose.Email реализует полный алгоритм объекта электронной почты S/MIME. Это дает API полную возможность сохранять цифровые подписи при конвертации сообщений между форматами.

### **Сохранение подписи при конвертации из EML в MSG**
При конвертации из EML в MSG установите флаг preserveSignature в true, чтобы сохранить подпись. Следующий фрагмент кода показывает, как выполнить конвертацию из EML в MSG.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ConvertEMLToMSG-ConvertEMLToMSG.cpp" >}}

### **Конвертация S/MIME сообщений из MSG в EML**
Aspose.Email сохраняет цифровую подпись при конвертации из MSG в EML, как показано в следующем фрагменте кода.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ConvertMIMEMessagesFromMSGToEML-ConvertMIMEMessagesFromMSGToEML.cpp" >}}

## **Установка цветовой категории для файлов MSG Outlook**
Цветовая категория обозначает важность или категорию электронного сообщения. Microsoft Outlook позволяет пользователям назначать цветовые категории для различения электронных писем. Для работы с цветовой категорией используйте FollowUpManager. В нем есть функции, такие как AddCategory, RemoveCategory, ClearCategories и GetCategories.

- AddCategory принимает MapiMessage и строку цветовой категории, например "Фиолетовая категория" или "Красная категория", в качестве аргументов.
- RemoveCategory принимает MapiMessage и строку цветовой категории, которую необходимо удалить из сообщения.
- ClearCategories() используется для удаления всех цветовых категорий из сообщения.
- GetCategories используется для получения всех цветовых категорий из конкретного сообщения.

Следующий пример выполняет задачи, указанные ниже:

1. Добавить цветовую категорию.
1. Добавить другую цветовую категорию.
1. Получить список всех категорий.
1. Удалить все категории.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SetColorCategories-SetColorCategories.cpp" >}}

## **Доступ к информации о последующих действиях из файла MSG**
API Aspose.Email предоставляет возможность получить информацию о последующих действиях из отправленного или полученного сообщения. Он может извлекать информацию о подтверждении чтения, подтверждении доставки и результатах голосования из файла сообщения.

### **Извлечение информации о чтении и подтверждении доставки**
Следующий фрагмент кода показывает, как извлечь информацию о чтении и подтверждении доставки.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-RetrieveReadAndDeliveryReceiptInformation-RetrieveReadAndDeliveryReceiptInformation.cpp" >}}