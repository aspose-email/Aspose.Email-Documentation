---
title: "Управление файлами сообщений Outlook с помощью API парсера электронной почты C++"
description: "API библиотеки C++ Email Parser Library полезен для чтения, написания OFT-файла шаблона Outlook, управления сообщениями с цифровой подписью, настройки цветовой категории и доступа к информации о получении."
url: /ru/cpp/managing-message-files-with-aspose-email-outlook/
weight: 30
type: docs
linktitle: "Управление файлами сообщений с помощью Aspose.Email.Outlook"
---

## **Чтение и запись файла шаблона Outlook (.OFT)**
Шаблоны Outlook очень полезны, если вы хотите снова и снова отправлять одно и то же сообщение электронной почты. Вместо того чтобы каждый раз готовить сообщение с нуля, сначала подготовьте сообщение в Outlook и сохраните его как шаблон Outlook (OFT). После этого каждый раз, когда вам нужно отправить сообщение, вы можете создать его на основе шаблона, сэкономив время на написании того же текста в тексте или теме письма, настройке форматирования и т. д. Класс MailMessage от Aspose.Email можно использовать для загрузки и чтения файла шаблона Outlook (OFT). После загрузки шаблона Outlook в экземпляр класса MailMessage вы можете обновить свойства отправителя, получателя, текст, тему и другие свойства. После обновления свойств выполните следующие действия:

- Отправьте электронное письмо, используя класс SmtpClient или
- Сохраните сообщение как MSG и выполните дальнейшие обновления/проверку с помощью Microsoft Outlook.

В приведенных ниже примерах кода мы:

1. Загрузите шаблон с помощью класса MailMessage.
1. Обновите некоторые свойства.
1. Сохраните сообщение в формате MSG.

В следующем фрагменте кода показано, как загрузить файл OFT с помощью API библиотеки C++ Email Parser Library, обновить сообщение и сохранить его в формате MSG.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ReadAndWritingOutlookTemplateFile-ReadAndWritingOutlookTemplateFile.cpp" >}}

## **Управление сообщениями с цифровой подписью**
Aspose.Email реализует полный алгоритм объекта электронной почты S/MIME. Это дает API полную возможность сохранять цифровые подписи при преобразовании сообщений между форматами.

### **Сохранение подписи при преобразовании из EML в MSG**
При преобразовании из EML в MSG установите для флага PreserveSignature значение true, чтобы сохранить подпись. В следующем фрагменте кода показано, как конвертировать EML в MSG.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ConvertEMLToMSG-ConvertEMLToMSG.cpp" >}}

### **Преобразование сообщений S/MIME из MSG в EML**
Aspose.Email сохраняет цифровую подпись при преобразовании из MSG в EML, как показано в следующем фрагменте кода.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ConvertMIMEMessagesFromMSGToEML-ConvertMIMEMessagesFromMSGToEML.cpp" >}}

## **Настройка цветовой категории для файлов Outlook MSG**
Цветовая категория обозначает сообщение электронной почты, относящееся к какой-либо важности или категории. Microsoft Outlook позволяет пользователям назначать цветовые категории для различения писем. Для обработки цветовой категории используйте FollowupManager. Он содержит такие функции, как AddCategory, RemoveCategory, ClearCategory и GetCategories.

- AddCategory принимает в качестве аргументов MapiMessage и строку цветовой категории, например «Фиолетовая категория» или «Красная категория».
- RemoveCategory принимает MapiMessage и строку цветовой категории, которые нужно удалить из сообщения.
- clearCategories () используется для удаления всех цветовых категорий из сообщения.
- GetCategories используется для извлечения всех цветовых категорий из определенного сообщения.

В следующем примере выполняются задачи, указанные ниже:

1. Добавьте цветовую категорию.
1. Добавьте еще одну цветовую категорию.
1. Получите список всех категорий.
1. Удалить все категории.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SetColorCategories-SetColorCategories.cpp" >}}

## **Доступ к дополнительной информации из файла MSG**
Aspose.Email API предоставляет возможность доступа к последующей информации из отправленного или полученного сообщения. Он может извлекать информацию о прочтении, доставке, прочтении и результатах голосования из файла сообщения.

### **Получение информации о прочтении и получении**
В следующем фрагменте кода показано, как получить информацию о прочтении и получении.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-RetrieveReadAndDeliveryReceiptInformation-RetrieveReadAndDeliveryReceiptInformation.cpp" >}}
