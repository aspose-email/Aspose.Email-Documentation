---
title: "Создание нового PST файла и добавление подпапок"
url: /ru/cpp/create-new-pst-file-and-add-subfolders/
weight: 10
type: docs
---

## **Создание нового PST файла и добавление подпапок**
Помимо разбора существующего PST файла, Aspose.Email предоставляет средства для создания PST файла с нуля. В этой статье показано, как создать файл PST для Outlook и добавить к нему подпапку.

1. Создание нового PST файла.
1. Изменение класса контейнера папки.

Используйте класс PersonalStorage для создания PST файла в определенном месте на локальном диске. Чтобы создать PST файл с нуля:

1. Создайте PST с помощью метода PersonalStorage.Create().
1. Добавьте подпапку в корень PST файла, получив доступ к корневой папке и затем вызвав метод AddSubFolder.

Следующий код показывает, как создать PST файл и добавить подпапку с именем Inbox.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-CreateNewPSTFileAndAddingSubfolders-CreateNewPSTFileAndAddingSubfolders.cpp" >}}
## **Изменение класса контейнера папки**
Иногда необходимо изменить класс папки. Частым примером является ситуация, когда сообщения разных типов (встречи, сообщения и т.д.) добавляются в одну и ту же папку. В таких случаях класс папки необходимо изменить, чтобы все элементы в папке отображались корректно. Следующий код показывает, как изменить класс контейнера папки в PST для этой цели.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ChangeFolderContainerClass-ChangeFolderContainerClass.cpp" >}}