---
title: "Создайте новый файл PST и добавьте подпапки"
url: /ru/cpp/create-new-pst-file-and-add-subfolders/
weight: 10
type: docs
---

## **Создание нового файла PST и добавление подпапок**
Помимо анализа существующего файла PST, Aspose.Email предоставляет средства для создания файла PST с нуля. В этой статье показано, как создать файл Outlook PST и добавить в него подпапку.

1. Создание нового файла PST.
1. Изменение класса контейнера папки.

Используйте класс PersonalStorage для создания файла PST в каком-либо месте на локальном диске. Чтобы создать файл PST с нуля, выполните следующие действия:

1. Создайте PST с помощью метода PersonalStorage.create ().
1. Добавьте подпапку в корень файла PST, открыв корневую папку и вызвав метод AddSubFolder.

В следующем фрагменте кода показано, как создать файл PST и добавить подпапку под названием «Входящие».



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-CreateNewPSTFileAndAddingSubfolders-CreateNewPSTFileAndAddingSubfolders.cpp" >}}
## **Изменение класса контейнера папки**
Иногда необходимо изменить класс папки. Типичный пример: сообщения разных типов (встречи, сообщения и т. д.) добавляются в одну и ту же папку. В таких случаях класс папки необходимо изменить, чтобы все элементы в папке отображались корректно. В следующем фрагменте кода показано, как изменить класс контейнера папки в PST для этой цели.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ChangeFolderContainerClass-ChangeFolderContainerClass.cpp" >}}
