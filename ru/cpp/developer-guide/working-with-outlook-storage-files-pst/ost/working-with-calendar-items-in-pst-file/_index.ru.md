---
title: "Работа с элементами календаря в файле PST"
url: /ru/cpp/working-with-calendar-items-in-pst-file/
weight: 50
type: docs
---

## **Добавление MapiCalendar в PST**
В статье «Создание нового файла PST и добавление подпапок» показано, как создать файл PST и добавить к нему подпапку. С помощью Aspose.Email вы можете добавить MapicaLendar в подпапку «Календарь» созданного или загруженного вами PST-файла. Ниже приведены шаги по добавлению MapicaLendar в PST:

1. Создайте объект MapicaLendar.
1. Задайте свойства MapicaLendar с помощью конструктора и методов.
1. Создайте PST с помощью метода PersonalStorage.create ().
1. Создайте предварительно определенную папку (Calendar) в корне файла PST, открыв корневую папку и вызвав метод addMapiMessageItem ().

В следующем фрагменте кода показано, как создать файл MapicaLendar, а затем добавить его в папку календаря вновь созданного файла PST.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddMapiCalendarToPST-AddMapiCalendarToPST.cpp" >}}
## **Сохранение элементов календаря из PST на диск в формате ICS**
В этой статье показано, как получить доступ к элементам календаря из файла Outlook PST и сохранить календарь на диск в формате ICS. Используйте классы PersonalStorage и MapicaLendar для получения информации из календаря. Ниже приведены шаги по сохранению элементов календаря:

1. Загрузите файл PST в класс PersonalStorage.
1. Перейдите в папку «Календарь».
1. Получите содержимое папки «Календарь», чтобы получить коллекцию сообщений.
1. Просмотрите коллекцию сообщений.
1. Вызовите метод PersonalStorage.extractMessage (), чтобы получить контактную информацию в классе MapicaLendar.
1. Вызовите метод MapiCalendar.save (), чтобы сохранить элемент календаря на диск в формате ICS.

Приведенная ниже программа загружает файл PST с диска и сохраняет все элементы календаря в формате ICS. Затем файлы ICS можно использовать в любой другой программе, которая может загрузить стандартный файл календаря ICS. Файл ICS, открытый в Microsoft Outlook, выглядит так, как показано на скриншоте ниже.

|![todo:image_alt_text](working-with-calendar-items-in-pst-file_1.png)|
|: - |
В следующем фрагменте кода показано, как экспортировать элементы календаря из Outlook PST в формат ICS.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SaveCalendarItems-SaveCalendarItems.cpp" >}}
