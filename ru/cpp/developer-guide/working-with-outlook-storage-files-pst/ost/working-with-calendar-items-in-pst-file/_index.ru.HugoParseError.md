---
title: Работа с элементами календаря в файле PST
type: docs
weight: 50
url: /cpp/working-with-calendar-items-in-pst-file/
---

## **Добавление MapiCalendar в PST**
Создание нового файла PST и добавление подкаталогов показывают, как создать файл PST и добавить в него подкаталог. С помощью Aspose.Email вы можете добавить MapiCalendar в подкаталог Календарь файла PST, который вы создали или загрузили. Ниже приведены шаги по добавлению MapiCalendar в PST:

1. Создайте объект MapiCalendar.
1. Установите свойства MapiCalendar с помощью конструктора и методов.
1. Создайте PST с помощью метода PersonalStorage.Create().
1. Создайте заранее определённую папку (Календарь) в корне файла PST, получив доступ к корневой папке и вызвав метод AddMapiMessageItem().

Следующий фрагмент кода показывает, как создать MapiCalendar и затем добавить его в папку календаря вновь созданного файла PST.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddMapiCalendarToPST-AddMapiCalendarToPST.cpp" >}}
## **Сохранение элементов календаря с PST на диск в формате ICS**
В этой статье показано, как получить доступ к элементам календаря из файла PST Outlook и сохранить календарь на диск в формате ICS. Используйте классы PersonalStorage и MapiCalendar для получения информации о календаре. Ниже приведены шаги по сохранению элементов календаря:

1. Загрузите файл PST в классе PersonalStorage.
1. Просмотрите папку Календарь.
1. Получите содержимое папки Календарь, чтобы получить коллекцию сообщений.
1. Просмотрите коллекцию сообщений.
1. Вызовите метод PersonalStorage.ExtractMessage(), чтобы получить контактную информацию в классе MapiCalendar.
1. Вызовите метод MapiCalendar.Save(), чтобы сохранить элемент календаря на диск в формате ICS.

Программа ниже загружает файл PST с диска и сохраняет все элементы календаря в формате ICS. Файлы ICS затем можно использовать в любой другой программе, которая может загружать стандартный файл календаря ICS. Открытый в Microsoft Outlook, файл ICS выглядит как на скриншоте ниже.

|![todo:image_alt_text](working-with-calendar-items-in-pst-file_1.png)|
| :- |
Следующий фрагмент кода показывает, как экспортировать элементы календаря из PST Outlook в формат ICS.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SaveCalendarItems-SaveCalendarItems.cpp" >}}