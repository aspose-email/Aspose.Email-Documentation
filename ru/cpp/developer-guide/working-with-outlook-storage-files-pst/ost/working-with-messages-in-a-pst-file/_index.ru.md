---
title: "Работа с сообщениями в файле PST"
url: /ru/cpp/working-with-messages-in-a-pst-file/
weight: 100
type: docs
---

## **Добавление сообщений в файлы PST**
Создание нового файла PST и добавление подпапок показало, как создать файл PST и добавить к нему подпапку. С помощью Aspose.Email вы можете добавлять сообщения в подпапки файла PST, который вы создали или загрузили. В данной статье добавляются два сообщения с диска в подпапку "Входящие" файла PST. Используйте классы PersonalStorage и FolderInfo, чтобы добавлять сообщения в файлы PST. Для добавления сообщений в папку "Входящие" файла PST:

1. Создайте экземпляр класса FolderInfo и загрузите его содержимое папки "Входящие".
1. Добавьте сообщения с диска в папку "Входящие", вызвав метод FolderInfo.AddMessage(). Класс FolderInfo предоставляет метод AddMessages, который позволяет добавлять большое количество сообщений в папку, уменьшая операции ввода-вывода на диск и улучшая производительность. Полный пример можно найти ниже, в разделе Добавление массовых сообщений.

Ниже приведены фрагменты кода, показывающие, как добавить сообщения в подпапку PST под названием "Входящие".



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddMessagesToPSTFiles-AddMessagesToPSTFiles.cpp" >}}
### **Сохранение сообщений напрямую из PST в поток**
Чтобы сохранить сообщения из файла PST непосредственно в поток, не извлекая MsgInfo для сообщений, используйте метод SaveMessageToStream(). Следующий фрагмент кода показывает, как сохранить сообщения напрямую из PST в поток.



{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Outlook-SaveMessagesDirectlyFromPSTToStream-SaveMessagesDirectlyFromPSTToStream.cs" >}}
### **Извлечение n количества сообщений из файла PST**
Следующий фрагмент кода показывает, как извлечь заданное количество сообщений из PST. Просто укажите индекс для первого сообщения и общее количество сообщений, которые необходимо извлечь.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ExtractNumberOfMessages-ExtractNnumberOfMessages.cpp" >}}
## **Поиск сообщений и папок в PST по критерию**
Файлы Личного Хранилища (PST) могут содержать огромное количество данных, и поиск данных, соответствующих определенному критерию, в таких больших файлах требует включения множества контрольных точек в код для фильтрации информации. С помощью класса PersonalStorageQueryBuilder Aspose.Email делает возможным поиск определенных записей в PST на основе заданного критерия поиска. В PST можно искать сообщения на основе параметров поиска, таких как отправитель, получатель, тема, важность сообщения, наличие вложений, размер сообщения и даже идентификатор сообщения. Класс PersonalStorageQueryBuilder также можно использовать для поиска подпапок.
### **Поиск сообщений и папок в PST**
Следующий фрагмент кода показывает, как использовать класс PersonalStorageQueryBuilder для поиска содержимого в PST на основе различных критериев поиска. Например, он демонстрирует поиск в PST на основе:

- Важности сообщения.
- Класса сообщения.
- Наличия вложений.
- Размер сообщений.
- Непрочитанных сообщений.
- Непрочитанных сообщений с вложениями и
- папок с определенным именем подпапки.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SearchMessagesAndFoldersInPST-SearchMessagesAndFoldersInPST.cpp" >}}
## **Извлечение вложений без извлечения полного сообщения**
API Aspose.Email может быть использован для извлечения вложений из сообщений PST без предварительного извлечения полного сообщения. Метод ExtractAttachments класса IEWSClient можно использовать для этого. Следующий фрагмент кода показывает, как извлекать вложения, не извлекая полное сообщение.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ExtractAttachmentsFromPSTMessages-ExtractAttachmentsFromPSTMessages.cpp" >}}
## **Добавление файлов в PST**
Основная функция Microsoft Outlook заключается в управлении электронной почтой, календарями, задачами, контактами и записями в журнале. Кроме того, файлы также могут быть добавлены в папку PST, и в результате PST сохраняет учетные записи добавленных документов. Aspose.Email предоставляет возможность добавлять файлы в папку так же, как и добавлять сообщения, контакты, задачи и записи в журнал в PST. Следующий фрагмент кода показывает, как добавлять документы в папку PST с использованием Aspose.Email.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddFilesToPST-AddFilesToPST.cpp" >}}