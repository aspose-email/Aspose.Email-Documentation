---
title: "Работа с сообщениями в файле PST"
url: /ru/cpp/working-with-messages-in-a-pst-file/
weight: 100
type: docs
---

## **Добавление сообщений в файлы PST**
В статье «Создание нового файла PST и добавление подпапок» показано, как создать файл PST и добавить к нему подпапку. С помощью Aspose.Email вы можете добавлять сообщения в подпапки созданного или загруженного файла PST. В этой статье два сообщения с диска добавляются во вложенную папку «Входящие» PST. Используйте классы PersonalStorage и FolderInfo для добавления сообщений в файлы PST. Чтобы добавить сообщения в папку «Входящие» файла PST, выполните следующие действия:

1. Создайте экземпляр класса FolderInfo и загрузите в него содержимое папки «Входящие».
1. Добавьте сообщения с диска в папку «Входящие», вызвав метод folderInfo.addMessage (). Класс FolderInfo предоставляет метод addMessages, который позволяет добавлять большое количество сообщений в папку, сокращая количество операций ввода-вывода на диск и повышая производительность. Полный пример можно найти ниже в разделе Добавление массовых сообщений.

В приведенных ниже фрагментах кода показано, как добавлять сообщения в подпапку PST под названием «Входящие».



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddMessagesToPSTFiles-AddMessagesToPSTFiles.cpp" >}}
### **Сохранение сообщений непосредственно из PST в потоковую передачу**
Чтобы сохранить сообщения из PST-файла непосредственно в поток, не извлекая MsgInfo для сообщений, используйте метод SaveMessageToStream (). В следующем фрагменте кода показано, как сохранять сообщения непосредственно из PST в потоковом режиме.



{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Outlook-SaveMessagesDirectlyFromPSTToStream-SaveMessagesDirectlyFromPSTToStream.cs" >}}
### **Извлечение n количества сообщений из PST-файла**
В следующем фрагменте кода показано, как извлечь заданное количество сообщений из PST. Просто укажите индекс первого сообщения и общее количество сообщений, которые нужно извлечь.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ExtractNumberOfMessages-ExtractNnumberOfMessages.cpp" >}}
## **Поиск сообщений и папок в PST по критерию**
Файлы персонального хранилища (PST) могут содержать огромное количество данных, и для поиска данных, соответствующих определенным критериям, в таких больших файлах необходимо включить в код несколько контрольных точек для фильтрации информации. Благодаря классу PersonalStorageQueryBuilder программа Aspose.Email позволяет искать определенные записи в PST на основе заданных критериев поиска. В PST можно искать сообщения на основе таких параметров поиска, как отправитель, получатель, тема, важность сообщения, наличие вложений, размер сообщения и даже идентификатор сообщения. PersonalStorageQueryBuilder также можно использовать для поиска подпапок.
### **Поиск сообщений и папок в PST**
В следующем фрагменте кода показано, как использовать класс PersonalStorageQueryBuilder для поиска содержимого в PST на основе различных критериев поиска. Например, показан поиск в PST на основе:

- Важность сообщения.
- Класс сообщений.
- Наличие вложений.
- Размер сообщения.
- Непрочитанные сообщения.
- Непрочитанные сообщения с вложениями и
- папки с определенным именем подпапки.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-SearchMessagesAndFoldersInPST-SearchMessagesAndFoldersInPST.cpp" >}}
## **Извлечение вложений без извлечения полного сообщения**
Aspose.Email API можно использовать для извлечения вложений из сообщений PST без предварительного извлечения всего сообщения. Для этого можно использовать метод ExtractAttachments в IEWSClient. В следующем фрагменте кода показано, как извлекать вложения без извлечения всего сообщения.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-ExtractAttachmentsFromPSTMessages-ExtractAttachmentsFromPSTMessages.cpp" >}}
## **Добавление файлов в PST**
Ключевые функции Microsoft Outlook — управление электронной почтой, календарями, задачами, контактами и записями журнала. Кроме того, файлы также можно добавлять в папку PST, и полученный PST сохраняет добавленные документы. Aspose.Email предоставляет возможность добавлять файлы в папку таким же образом, а также добавлять сообщения, контакты, задачи и записи журнала в PST. В следующем фрагменте кода показано, как добавлять документы в папку PST с помощью Aspose.Email.



{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Outlook-AddFilesToPST-AddFilesToPST.cpp" >}}
