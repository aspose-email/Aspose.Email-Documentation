---
title: "Работа с вложениями и встроенными объектами с использованием библиотеки C++ Email Parser"
description: "Вы можете добавлять и удалять вложения электронной почты, отображать имя файла вложения и работать со встроенными объектами, используя API библиотеки C++ Email Parser."
url: /ru/cpp/working-with-attachments-and-embedded-objects/
weight: 50
type: docs
linktitle: "Работа с вложениями и встроенными объектами"
---

## **Управление вложениями электронной почты**
Вложение электронной почты — это файл на компьютере, который отправляется вместе с сообщением электронной почты. Файл может быть отправлен как отдельное сообщение, так и в составе сообщения, к которому он прикреплен. Класс Attachment используется вместе с классом MailMessage. Все сообщения имеют тело. В дополнение к телу, вы можете захотеть отправить дополнительные файлы. Эти файлы отправляются как вложения и представлены экземплярами класса Attachment. Вы можете отправить любое количество вложений, но размер вложения ограничен почтовым сервером. Gmail, например, не поддерживает размеры файлов более 10MB.
{{% alert %}}
**Попробуйте это!**

Добавьте или удалите вложения электронной почты с помощью бесплатного [**Aspose.Email Editor App**](https://products.aspose.app/email/ru/editor).
{{% /alert %}}
### **Добавление вложения**
Чтобы прикрепить вложение к сообщению электронной почты, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Создайте экземпляр класса Attachment.
1. Загрузите вложение в экземпляр Attachment.
1. Добавьте экземпляр Attachment в экземпляр класса MailMessage.

Следующий фрагмент кода показывает, как добавить вложение к сообщению электронной почты.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-AddEmailAttachments-AddEmailAttachments.cpp" >}}

Выше мы описали, как добавить вложения к сообщению электронной почты с помощью Aspose.Email. Далее показано, как удалить вложения и отобразить информацию о них на экране.

### **Удаление вложения**
Чтобы удалить вложение, выполните следующие шаги:

- Создайте экземпляр класса Attachment.
- Загрузите вложение в экземпляр класса Attachment.
- Добавьте вложение в экземпляр класса MailMessage.
- Удалите вложения из экземпляра класса Attachment, используя экземпляр класса MailMessage.

Следующий фрагмент кода показывает, как удалить вложение.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-RemoveAttachments-RemoveAttachments.cpp" >}}

### **Отображение имени файла вложения**
Чтобы отобразить имя файла вложения, выполните следующие шаги:

1. Переберите вложения в сообщении электронной почты и
   1. Сохраните каждое вложение.
   1. Отобразите имя каждого вложения на экране.

Следующий фрагмент кода показывает, как отобразить имя файла вложения на экране.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-DisplayAttachmentFileName-DisplayAttachmentFileName.cpp" >}}

### **Извлечение вложений электронной почты**
Эта тема объясняет, как извлечь вложение из файла электронной почты. Вложение электронной почты — это файл на компьютере, который отправляется вместе с сообщением электронной почты. Файл может быть отправлен как отдельное сообщение, так и в составе сообщения, к которому он прикреплен. Все сообщения электронной почты содержат тело. Кроме тела, вы можете захотеть отправить дополнительные файлы. Эти файлы отправляются как вложения и представлены экземплярами класса Attachment. Класс Attachment используется вместе с классом MailMessage для работы с вложениями. Для извлечения вложений из сообщения электронной почты выполните следующие шаги:

- Создайте экземпляр класса MailMessage.
- Загрузите файл электронной почты в экземпляр MailMessage.
- Создайте экземпляр класса Attachment и используйте его в цикле для извлечения всех вложений.
- Сохраните вложение и отобразите его на экране.
- Укажите адрес отправителя и получателя в экземпляре MailMessage.
- Фрагменты кода извлекают вложения из электронной почты.

|**Извлеченные вложения в электронной почте**|
| :- |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_1.png)|
Следующий фрагмент кода показывает, как извлечь вложения из электронной почты.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.cpp" >}}
#### **Получение Content-Description из вложения**
API Aspose.Email предоставляет возможность читать Content-Description вложения из заголовка вложения. Следующий фрагмент кода показывает, как получить описание содержимого из вложения.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-RetrieveContentDescriptionFromAttachment-RetrieveContentDescriptionFromAttachment.cpp" >}}
## **Работа с встроенными объектами**
Встроенный объект — это объект, который был создан с помощью одного приложения и заключен в документ или файл, созданный другим приложением. Например, таблица Microsoft Excel может быть встроена в отчет Microsoft Word, или видеофайл может быть встроен в презентацию Microsoft PowerPoint. Когда файл встроен, а не вставлен или скопирован в другой документ, он сохраняет свой исходный формат. Встроенный документ может быть открыт в исходном приложении и изменен.
### **Встраивание объектов в электронную почту**
Класс LinkedResources используется вместе с классом MailMessage для встраивания объектов в ваши сообщения электронной почты. Чтобы добавить встроенный объект, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Укажите значения from, to и subject в экземпляре MailMessage.
1. Создайте экземпляр класса AlternateView.
1. Создайте экземпляр класса LinkedResources.
1. Загрузите встроенный объект в экземпляр LinkedResources.
1. Добавьте загруженный встроенный объект в экземпляр класса MailMessage.
1. Добавьте экземпляр AlternateViews в экземпляр класса MailMessage.

Фрагменты кода ниже создают сообщение электронной почты с текстовыми и HTML-телами и изображением, встроенным в HTML.

|**Изображение, встроенное в электронную почту**|
| :- |
|![todo:image_alt_text](/plugins/servlet/confluence/placeholder/unknown-attachment)|
Вы можете отправить любое количество встроенных объектов. Размер вложения ограничен почтовым сервером. Gmail, например, не поддерживает размеры файлов более 10MB. Фрагменты кода ниже показывают, как встраивать объекты в электронную почту.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-EmbeddedObjects-EmbeddedObjects.cpp" >}}
### **Извлечение встроенных объектов**
Эта тема объясняет, как извлечь встроенные объекты из файла электронной почты. Встроенный объект — это объект, который был создан с помощью одного приложения и заключен в документ или файл, созданный другим приложением. Например, таблица Microsoft Excel может быть встроена в отчет Microsoft Word, или видеофайл может быть встроен в презентацию Microsoft PowerPoint. Когда файл встроен, а не вставлен или скопирован в другой документ, он сохраняет свой исходный формат. Встроенный документ может быть открыт в исходном приложении и изменен. Чтобы извлечь встроенный объект из сообщения электронной почты, выполните следующие шаги:

1. Создайте экземпляр класса MailMessage.
1. Загрузите файл электронной почты в экземпляр MailMessage.
1. Создайте цикл и создайте в нем экземпляр класса Attachment.
1. Сохраните вложение и отобразите его на экране.
1. Укажите адрес отправителя и получателя в экземпляре MailMessage.
1. Фрагмент кода ниже извлекает встроенные объекты из электронной почты.

|**Извлеченные встроенные объекты в электронной почте**|
| :- |
|![todo:image_alt_text](working-with-attachments-and-embedded-objects_2.png)|
Следующий фрагмент кода показывает, как извлечь встроенные объекты.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-ExtractEmbeddedObjectsFromEmail-ExtractEmbeddedObjectsFromEmail.cpp" >}}