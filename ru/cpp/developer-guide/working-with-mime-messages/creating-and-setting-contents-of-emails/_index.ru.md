---
title: "Создание и настройка содержимого электронной почты в C++ и отправка электронной почты с помощью SmtpClient"
description: "Для создания и настройки содержимого электронной почты в C++ используйте класс MailMessage, который может создавать и сохранять почтовые сообщения в различных форматах, таких как EML, MSG и MHTML."
url: /ru/cpp/creating-and-setting-contents-of-emails/
weight: 10
type: docs
linktitle: "Создание и настройка содержимого электронной почты"
keywords: "c++ отправка электронной почты"
---

## **Создание нового сообщения электронной почты**
Класс MailMessage представляет собой сообщение электронной почты и позволяет разработчикам создавать новое сообщение электронной почты. Основные свойства электронной почты, такие как От, Кому, Тема и тело, могут быть легко прикреплены к вновь созданному почтовому сообщению. Аналогично, мы можем сохранить почтовое сообщение в различных форматах, таких как EML, MSG и MHTML.

<a name="csharp-create-new-email-msg" id="csharp-create-new-email-msg"><strong>Шаги: Создание нового сообщения электронной почты в C#</strong></a>

- Создайте экземпляр класса MailMessage.
- Установите свойства почтового сообщения.
- Сохраните почтовое сообщение в различных форматах.
- Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

Следующий кодовый фрагмент C++ показывает, как создать новое электронное письмо с различными свойствами.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-CreateNewMailMessage-CreateNewMailMessage.cpp" >}}

## **Изменение адресов электронной почты на дружелюбные имена**
Программные примеры, приведенные ниже, демонстрируют, как изменить адреса электронной почты на дружелюбные имена в сообщении электронной почты. Дружелюбное имя — это имя, которое более удобно для человека, чем адрес электронной почты, например, Джон Смит вместо js346@domain.com. При отправке электронной почты мы можем ассоциировать дружелюбное имя с адресом электронной почты в конструкторе класса MailMessage.

Чтобы изменить адреса электронной почты на дружелюбные имена в сообщении электронной почты, выполните следующие шаги:

- Создайте экземпляр класса MailMessage и укажите адреса электронной почты в полях **Кому** и **От** вместе с дружелюбными именами.
- Укажите адреса электронной почты Cc и Bcc вместе с дружелюбными именами, вызвав конструктор класса MailMessage в экземпляре MailMessage.
- Создайте экземпляр класса SmtpClient и отправьте электронную почту с помощью метода Send.

Следующий кодовый фрагмент показывает, как отобразить имена для адресов электронной почты.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-ChangeEmailAddress-ChangeEmailAddress.cpp" >}}

## **Установка тела письма**
Класс MailMessage представляет собой сообщение электронной почты. Экземпляры класса MailMessage используются для создания сообщений электронной почты, которые передаются на SMTP-сервер для доставки с использованием класса SmtpClient. Тело письма можно задать с помощью класса MailMessage. У электронной почты может быть несколько тел. В классе MailMessage есть два типа тел:

- HTML-тело
- Текстовое тело

Кроме HtmlBody и TextBody, Aspose.Email имеет еще два свойства только для чтения, относящихся к телу письма:

- IsBodyText: сообщает пользователю, является ли тело текстовым.
- IsBodyHtml: сообщает пользователю, является ли тело HTML или обычным текстом.

Эта статья показывает, как определить текст обыкновенного текста или HTML, установить альтернативный текст и закодировать тело электронной почты.

### **Установка HTML-тела**
[HtmlBody](https://reference.aspose.com/email/cpp/class/aspose.email.mail_message) используется для указания HTML-содержимого тела сообщения. HtmlBody должен быть заключен между тегами <html> </html>. Следующий кодовый фрагмент показывает, как установить HTML-тело.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-SetHTMLBody-SetHTMLBody.cpp" >}}

### **Установка альтернативного текста**
Используйте класс AlternateView для указания копий сообщения электронной почты в другом формате. Например, если вы отправляете сообщение в HTML, вы также можете предоставить версию в обычном тексте на случай, если некоторые из получателей используют почтовые клиенты, которые не могут отображать HTML-контент. Этот класс имеет два свойства, LinkedResources и BaseUri, которые используются для разрешения URL-адресов в содержимом электронной почты.

- LinkedResources — это коллекция объектов LinkedResources. При рендеринге URL-адреса в содержимом электронной почты сначала сопоставляются с URL-адресами в ссылке на содержимое каждого объекта LinkedResources в коллекции LinkedResources и разрешаются.
- BaseUri используется почтовым читателем для разрешения относительных URL-адресов в теле, а также для разрешения относительных URL-адресов ссылок на содержимое в коллекции LinkedResources.

Следующий кодовый фрагмент C++ показывает, как установить альтернативный текст.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-SetAlternateText-SetAlternateText.cpp" >}}