---
title: "Создание и настройка содержимого писем на языке C++ и отправка электронной почты с помощью SmtpClient"
description: "Чтобы создать и настроить содержимое электронной почты на языке C++, используйте класс MailMessage, который может создавать и сохранять почтовое сообщение в различных форматах, таких как EML, MSG и MHTML."
url: /ru/cpp/creating-and-setting-contents-of-emails/
weight: 10
type: docs
linktitle: "Создание и настройка содержимого электронных писем"
keywords: "c++ отправить электронное письмо"
---

## **Создать новое сообщение электронной почты**
Класс MailMessage представляет собой сообщение электронной почты и позволяет разработчикам создавать новое сообщение электронной почты. Основные свойства электронной почты, такие как «От», «Кому», «Тема» и «Текст», можно легко прикрепить к вновь созданному почтовому сообщению. Точно так же мы можем сохранить почтовое сообщение в разных форматах, таких как EML, MSG и MHTML.

<a name="csharp-create-new-email-msg" id="csharp-create-new-email-msg"><strong>Шаги: создание нового сообщения электронной почты на C #</strong></a>

- Создайте экземпляр класса MailMessage.
- Задайте свойства почтового сообщения.
- Сохраните почтовое сообщение в разных форматах.
- Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

В следующем фрагменте кода на языке C++ показано, как создать новое электронное письмо с другими свойствами.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-CreateNewMailMessage-CreateNewMailMessage.cpp" >}}

## **Изменение адресов электронной почты на понятное имя**
В приведенных ниже примерах программирования показано, как изменить адреса электронной почты на удобные имена в сообщении электронной почты. Дружественное имя — это имя, более удобное для пользователя, чем адрес электронной почты. Например, Джон Смит вместо js346@domain.com. При отправке электронного письма мы можем связать понятное имя с адресом электронной почты в конструкторе класса MailMessage.

Чтобы изменить адреса электронной почты на удобные имена в сообщении электронной почты, выполните следующие действия:

- Создайте экземпляр класса MailMessage и укажите адреса электронной почты в поле **To** and **From** поля вместе с понятными именами.
- Укажите адреса электронной почты Cc и Bcc, а также удобные имена, вызвав конструктор класса MailMessage в экземпляре MailMessage.
- Создайте экземпляр класса SmtpClient и отправьте электронное письмо с помощью метода Send.

В следующем фрагменте кода показано, как отображать имена для адресов электронной почты.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-ChangeEmailAddress-ChangeEmailAddress.cpp" >}}

## **Установить тело письма**
Класс MailMessage представляет собой сообщение электронной почты. Экземпляры класса MailMessage используются для создания сообщений электронной почты, которые передаются на SMTP-сервер для доставки с использованием класса SmtpClient. Текст письма можно указать с помощью класса MailMessage. Электронное письмо может состоять из нескольких текстов. В классе MailMessage существует два типа сообщений электронной почты:

- Тело HTML
- Тело текста

Помимо HTMLBody и TextBody, Aspose.Email имеет еще два свойства, доступных только для чтения, связанных с телом письма:

- isBodyText: сообщает пользователю, является ли текст текстом.
- isBodyHTML: сообщает пользователю, является ли тело HTML или обычным текстом.

В этой статье показано, как определить простой текст или основной текст HTML, задать альтернативный текст и закодировать тело письма.

### **Настройка тела HTML**
[HtmlBody](https://reference.aspose.com/email/cpp/class/aspose.email.mail_message) используется для указания HTML-содержимого тела сообщения. HTMLBody должен быть заключен между <html> </html> теги. В следующем фрагменте кода показано, как настроить тело HTML.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-SetHTMLBody-SetHTMLBody.cpp" >}}

### **Настройка альтернативного текста**
Используйте класс AlternateView для указания копий сообщения электронной почты в другом формате. Например, если вы отправляете сообщение в формате HTML, вы также можете предоставить текстовую версию на случай, если некоторые из получателей используют программы чтения электронной почты, которые не могут отображать содержимое HTML. Этот класс имеет два свойства, LinkedResources и baseURI, которые используются для разрешения URL-адресов в содержимом письма.

- LinkedResources — это набор объектов LinkedResources. При рендеринге URL-адреса в содержимом письма сначала сопоставляются с URL-адресами в ссылке на содержимое каждого объекта LinkedResources в коллекции LinkedResources и затем удаляются.
- BaseURI используется программой чтения почты для разрешения относительных URL-адресов в тексте, а также для разрешения относительных URL-адресов ссылок на содержимое в коллекции LinkedResources.

В следующем фрагменте кода на C++ показано, как задать альтернативный текст.

{{< gist "aspose-email" "ef0db907527892c88c557bb418093cee" "Examples-EmailCPP-Email-SetAlternateText-SetAlternateText.cpp" >}}
