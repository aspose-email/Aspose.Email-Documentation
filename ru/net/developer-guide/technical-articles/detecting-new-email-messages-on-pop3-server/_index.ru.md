---
title: "Обнаружение новых писем на сервере POP3"
url: /ru/net/detecting-new-email-messages-on-pop3-server/
weight: 100
type: docs
---


С помощью учетных записей POP3 вы можете оставлять сообщения на сервере при их загрузке и чтении. Оставление писем на сервере означает, что они доступны другим приложениям и пользователям, например, пользователям, которые получают доступ к своей электронной почте с нескольких устройств. Или вы можете захотеть загружать только те сообщения, которые соответствуют особым критериям, например, сообщения с определенной темой. Для управления электронной почтой вы можете:

- Читать все сообщения с почтового сервера POP3 с помощью Aspose.Email.
- Загружать сообщения в вашу локальную базу данных.

Сообщения не удаляются, а остаются на сервере. При первом запуске этот процесс работает нормально. Все необходимые сообщения загружаются в базу данных. Но при втором запуске загружаются те же сообщения, потому что они все еще находятся на почтовом сервере. Это приводит к дублированию записей. Чтобы решить эту проблему, используйте свойство [Pop3MessageInfo.UniqueID](https://apireference.aspose.com/net/email/aspose.email.clients.pop3/pop3messageinfo/properties/uniqueid) для проверки, было ли сообщение уже загружено. Уникальный идентификатор сообщения должен храниться в базе данных: это ключ для поиска новых сообщений.
## **Обнаружение новых сообщений**
Чтобы идентифицировать новые электронные письма из списка писем на сервере POP3:

1. Подключитесь к серверу.
1. Получите список писем.
1. Подключитесь к базе данных.
1. Получите список писем.
1. Сравните списки.
1. Сохраните новые письма в базе данных.

Процесс проходит быстрее, когда вы:

1. Извлекаете все уникальные идентификаторы сообщений в хэш-таблицу.
1. Ищете в хэш-таблице вместо базы данных для каждого электронного письма в цикле foreach(…).

Вместо запроса к базе данных для каждого сообщения, что требует множества вызовов к базе данных, этот метод требует только одного вызова. Следующий код показывает, как обнаружить новые письма на сервере POP3.



{{< gist "aspose-com-gists" "6e5185a63aec6fd70d83098e82b06a32" "Examples-CSharp-Knowledge-Base-DetectingNewMessages-DetectingNewMessages.cs" >}}