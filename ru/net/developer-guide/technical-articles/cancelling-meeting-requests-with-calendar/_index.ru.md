---
title: "Отмена запросов на встречу с помощью Календаря"
url: /ru/net/cancelling-meeting-requests-with-calendar/
weight: 270
type: docs
---


Вы можете отправить запрос на отмену встречи с помощью Aspose.Email, используя объект класса Appointment. Вам необходимо иметь информацию о первоначальном запросе встречи, чтобы отменить его. Пример в этой статье сначала отправляет запрос на встречу, сохраняет информацию в базе данных, а затем отменяет запрос на основе идентификатора сообщения.
## **Отправка запросов на встречу**
Прежде чем мы сможем [отменить запросы на встречу](#cancelling-meeting-request), мы должны сначала их отправить:

1. Сначала создайте экземпляр типа SmtpClient для отправки сообщения.
1. Для сбора информации об участниках мы создали таблицу данных, чтобы пользователи могли вводить имена и адреса людей, которым должно быть отправлено приглашение.
1. После выполнения цикла по коллекции Rows таблицы сохраните всю информацию об участниках в коллекцию MailAddressCollection.
1. Создайте экземпляр класса MailMessage и необходимые свойства, такие как From, To и Subject.
1. Создайте экземпляр типа Appointment и укажите местоположение, время начала, время окончания, организаторов и информацию об участниках.
1. Сохраните всю информацию в базе данных SQL Server. Работа с БД выполняется в методе SaveIntoDB.

Следующий фрагмент кода показывает, как отправить запросы на встречу.



{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Knowledge-Base-SendMeetingRequests-SendMeetingRequests.cs" >}}
## **Отмена запроса на встречу**
Чтобы отменить запрос на встречу, сначала получите идентификатор сообщения электронной почты. Поскольку мы сохранили эту информацию в базе данных для этого примера, мы можем легко получить ее снова. Мы использовали таблицу для загрузки всех отправленных сообщений. Скриншот формы приведен ниже: 

![todo:image_alt_text](cancelling-meeting-requests-with-calendar_1.png)

1. Выберите строку, для которой хотите отправить запрос на отмену.
1. Нажмите **Отправить запрос на отмену**, чтобы отправить запрос.
1. Код получает идентификатор из выбранной строки таблицы и запрашивает базу данных, чтобы получить информацию об участниках, сообщении и календаре.
1. Создайте экземпляры классов Calendar и [MailMessage](https://apireference.aspose.com/email/net/aspose.email/mailmessage), используя информацию, полученную из базы данных.
1. Используйте метод Appointment.CancelAppointment(), чтобы отправить запрос на отмену.
1. Отправьте письмо с помощью [SMTP](https://apireference.aspose.com/email/net/aspose.email.clients.smtp/smtpclient).

Следующий фрагмент кода показывает, как отменить запрос на встречу.



{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Knowledge-Base-CancelMeetingRequest-CancelMeetingRequest.cs" >}}