---
title: "Класс Wrapper для асинхронной загрузки сообщений электронной почты с помощью Aspose.Email"
url: /ru/net/wrapper-class-for-loading-email-messages-async-using-aspose-email/
weight: 170
type: docs
---


## **Класс Wrapper для загрузки сообщений электронной почты**
В ряде случаев желательно использовать функцию «Тайм-аут», чтобы прервать действие, которое занимает ненужное время. В этой статье представлен пример класса, позволяющего реализовать функциональность функции Time Out при загрузке файлов EML/MSG, загрузка которых может привести к очень длительным задержкам или сбоям. Поскольку Time out напрямую не связан с операциями чтения/записи на диск или в сети, бесполезно внедрять эту функцию в API, чем реализовывать ее на стороне пользователя, написав класс-оболочку на основе Aspose.

Отмена длительно выполняющегося потока может быть достигнута с помощью обернутого делегата, который передает поток и удаляет его в локальную переменную в инициировавшем его методе. Длительный поток отменяется путем его прерывания, а управление возвращается основному приложению. В следующем примере кода представлен пример класса-оболочки для библиотеки Aspose.Email. В коде также приведен пример использования класса-оболочки.
### **Пример программирования на платформе.NET 3.5 и выше**


{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Knowledge-Base-WrapperMailMessage-WrapperMailMessage.cs" >}}
### **Пример программирования на платформе.NET 2.0**


{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Knowledge-Base-WrapperMailMessage_2_0-WrapperMailMessage.cs" >}}
### **Пример использования**


{{< gist "aspose-email" "9e8fbeb51a8cbc4129dc71ca8cd55f0b" "Examples-CSharp-Knowledge-Base-UsingMailMessageWrapper-UsingMailMessageWrapper.cs" >}}
